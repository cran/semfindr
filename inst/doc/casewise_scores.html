<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />


<meta name="date" content="2025-03-04" />

<title>Approximate Case Influence Using Scores and Casewise Likelihood</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Approximate Case Influence Using Scores and
Casewise Likelihood</h1>
<h4 class="date">2025-03-04</h4>



<p>This vignette explains the computational shortcut implemented in <a href="https://sfcheung.github.io/semfindr/">semfindr</a> to approximate
the casewise influence. The approximation is most beneficial when the
sample size <em>N</em> is large, where the approximation works better
and the computational cost for refitting models <em>N</em> times is
high.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(semfindr)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>dat <span class="ot">&lt;-</span> pa_dat</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#&gt; This is lavaan 0.6-19</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt; lavaan is FREE software! Please report any bugs.</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>mod <span class="ot">&lt;-</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="st">m1 ~ iv1 + iv2</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="st">dv ~ m1</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(mod, dat)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">&quot;semfindr_fit_rerun.RDS&quot;</span>)) {</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>    fit_rerun <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;semfindr_fit_rerun.RDS&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    fit_rerun <span class="ot">&lt;-</span> <span class="fu">lavaan_rerun</span>(fit)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>    <span class="fu">saveRDS</span>(fit_rerun, <span class="st">&quot;semfindr_fit_rerun.RDS&quot;</span>)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  }</span></code></pre></div>
<div id="using-scores-to-approximate-case-influence" class="section level2">
<h2>Using Scores to Approximate Case Influence</h2>
<p><code>lavaan</code> provides the handy <code>lavScores()</code>
function to evaluate <span class="math display">\[s_i(\theta_m) =
\frac{\partial \ell_i(\theta_m)}{\partial \theta_m}\]</span> for
observation <span class="math inline">\(i\)</span>, where <span class="math inline">\(\ell_i(\theta)\)</span> denotes the casewise
loglikelihood function and <span class="math inline">\(\theta_m\)</span>
is the <span class="math inline">\(m\)</span>th model parameter.</p>
<p>For example,</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">lavScores</span>(fit)[ , <span class="dv">1</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt;           m1~iv1</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; [1,]  0.23975993</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; [2,]  0.06630118</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; [3,] -0.33999129</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; [4,] -0.22536120</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; [5,]  0.61375747</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; [6,]  0.03747179</span></span></code></pre></div>
<p>indicates the partial derivative of the casewise loglikelihod with
respect to the parameter <code>m1~iv1</code>. Because the sum of the
partial derivatives across all observations is zero at the maximum
likelihood estimate with the full sample (<span class="math inline">\(\hat \theta_m\)</span>; i.e., the derivative of
loglikelihood of the full data is 0), <span class="math inline">\(-
s_i(\theta_m)\)</span> can be used as an estimate of the partial
derivative of the loglikelihood at <span class="math inline">\(\hat
\theta_m\)</span> <strong>for the sample without observation <span class="math inline">\(i\)</span></strong>. This information can be used
to approximate the maximum likelihood estimate for <span class="math inline">\(\theta_m\)</span> when case <span class="math inline">\(i\)</span> is dropped, denoted as <span class="math inline">\(\hat \theta_{m(-i)}\)</span></p>
<p>The second-order Taylor series expansion can be used to approximate
the parameter vector estimate with an observation deleted, <span class="math inline">\(\hat \theta_{(-i)}\)</span>, as in the iterative
<a href="https://en.wikipedia.org/wiki/Newton%27s_method_in_optimization">Newton’s
method</a>. Specifically,</p>
<p><span class="math display">\[\hat \theta_{(i)} \approx \hat \theta -
\frac{N}{N - 1}V(\hat \theta) \nabla \ell(\hat \theta)\]</span> <span class="math display">\[\hat \theta - \hat \theta_{(i)} \approx
\frac{N}{N - 1}V(\hat \theta) \nabla \ell_i(\hat \theta),\]</span> where
<span class="math inline">\(\nabla \ell_i(\hat \theta)\)</span> is the
gradient vector of the casewise loglikelihood with respect to the
parameters (i.e., score). The <span class="math inline">\(N / (N -
1)\)</span> term is used to adjust for the decrease in sample size (this
adjustment is trivial in large samples). This procedure should be the
same as equation (4) of <a href="https://doi.org/10.1080/03610929108830742">Tanaka et
al. (1991)</a> (p. 3807) and is related to the one-step approximation
described by <a href="https://conservancy.umn.edu/handle/11299/37076">Cook and Weisberg
(1982)</a> (p. 182).</p>
<div id="comparison" class="section level3">
<h3>Comparison</h3>
<p>The approximation is implemented in the
<code>est_change_raw_approx()</code> function:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>fit_est_change_approx <span class="ot">&lt;-</span> <span class="fu">est_change_raw_approx</span>(fit)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>fit_est_change_approx</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; -- Approximate Case Influence on Parameter Estimates --</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt;    id m1~iv1  id m1~iv2 id  dv~m1  id m1~~m1 id dv~~dv</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; 1  51  0.042  43 -0.025 65  0.037  61  0.042 16  0.106</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; 2  43 -0.040  94  0.023 11 -0.027  85  0.040  9  0.050</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; 3  34 -0.032 100 -0.022 16 -0.024 100  0.037 76  0.049</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; 4  18 -0.028  85  0.021 32 -0.020  18  0.031 25  0.049</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; 5  13  0.028  20  0.020 99  0.020  42  0.028 91  0.043</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; 6  32 -0.025  32  0.019 79  0.018  43  0.025 17  0.039</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; 7  20 -0.024  65  0.019 93  0.018  32  0.023 26  0.028</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; 8  75  0.021  34 -0.018 22  0.017  34  0.022 65  0.027</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; 9  42 -0.020  64 -0.016 61 -0.016  40  0.022 62  0.027</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; 10 68  0.018  52  0.016 25 -0.015  20  0.022 90  0.024</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt; Note:</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt; - Changes are approximate raw changes if a case is included.</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt; - Only the first 10 case(s) is/are displayed. Set &#39;first&#39; to NULL to display all cases.</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt; - Cases sorted by the absolute changes for each variable.</span></span></code></pre></div>
<p>Here is a comparison between the approximation using
<code>semfindr::est_change_raw_approx()</code> and
<code>semfindr::est_change_raw()</code></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># From semfindr</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>fit_est_change_raw <span class="ot">&lt;-</span> <span class="fu">est_change_raw</span>(fit_rerun)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co"># Plot the differences</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>tmp1 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">t</span>(<span class="fu">as.matrix</span>(fit_est_change_raw)))</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>tmp2 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">t</span>(<span class="fu">as.matrix</span>(fit_est_change_approx)))</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>est_change_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">rep</span>(<span class="fu">colnames</span>(fit_est_change_raw),</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>                                        <span class="fu">nrow</span>(fit_est_change_raw)),</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>                             <span class="at">est_change =</span> tmp1,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>                             <span class="at">est_change_approx =</span> tmp2)</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="fu">ggplot</span>(est_change_df, <span class="fu">aes</span>(<span class="at">x =</span> est_change, <span class="at">y =</span> est_change_approx)) <span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> param) <span class="sc">+</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The results are pretty similar.</p>
</div>
<div id="generalized-cooks-distance-gcd" class="section level3">
<h3>Generalized Cook’s distance (<em>gCD</em>)</h3>
<p>We can use the approximate parameter changes to approximate the
<em>gCD</em> (see also Tanaka et al., 1991, equation 13, p. 3811):</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Information matrix (Hessian)</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>information_fit <span class="ot">&lt;-</span> <span class="fu">lavInspect</span>(fit, <span class="at">what =</span> <span class="st">&quot;information&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co"># Short cut for computing quadratic form (https://stackoverflow.com/questions/27157127/efficient-way-of-calculating-quadratic-forms-avoid-for-loops)</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>gcd_approx <span class="ot">&lt;-</span> (<span class="fu">nobs</span>(fit) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">rowSums</span>(</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  (fit_est_change_approx <span class="sc">%*%</span> information_fit) <span class="sc">*</span> fit_est_change_approx</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>)</span></code></pre></div>
<p>This is implemented in the <code>est_change_approx()</code>
function:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>fit_est_change_approx <span class="ot">&lt;-</span> <span class="fu">est_change_approx</span>(fit)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>fit_est_change_approx</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; -- Approximate Standardized Case Influence on Parameter Estimates --</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt;     m1~iv1 m1~iv2  dv~m1 m1~~m1 dv~~dv gcd_approx</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; 16   0.052 -0.038 -0.228 -0.006  0.572      0.372</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; 43  -0.387 -0.249 -0.135  0.201  0.116      0.270</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; 65   0.150  0.189  0.355  0.071  0.148      0.203</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; 85  -0.170  0.211 -0.118  0.315 -0.054      0.187</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; 51   0.405 -0.052  0.094  0.075 -0.046      0.179</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; 34  -0.306 -0.186 -0.110  0.176  0.028      0.163</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; 32  -0.241  0.190 -0.189  0.181 -0.002      0.161</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; 20  -0.234  0.199 -0.140  0.172 -0.034      0.144</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt; 18  -0.269  0.035  0.101  0.246 -0.048      0.143</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt; 100 -0.001 -0.221 -0.069  0.290 -0.058      0.137</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt; Note:</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; - Changes are approximate standardized raw changes if a case is included.</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt; - Only the first 10 case(s) is/are displayed. Set &#39;first&#39; to NULL to display all cases.</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt; - Cases sorted by approximate generalized Cook&#39;s distance.</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Compare to exact computation</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>fit_est_change <span class="ot">&lt;-</span> <span class="fu">est_change</span>(fit_rerun)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>gcd_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  <span class="at">gcd_exact =</span> fit_est_change[ , <span class="st">&quot;gcd&quot;</span>],</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>  <span class="at">gcd_approx =</span> fit_est_change_approx[ , <span class="st">&quot;gcd_approx&quot;</span>]</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>)</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="fu">ggplot</span>(gcd_df, <span class="fu">aes</span>(<span class="at">x =</span> gcd_exact, <span class="at">y =</span> gcd_approx)) <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The approximation tend to underestimate the actual <em>gCD</em> but
the rank ordering is almost identical. This is discussed also in Tanaka
et al. (1991), who proposed a correction by applying a one-step
approximation after the correction (currently not implemented due to the
need to recompute scores with updated parameter values).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">cor</span>(gcd_df, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt;            gcd_exact gcd_approx</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt; gcd_exact   1.000000   0.999892</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt; gcd_approx  0.999892   1.000000</span></span></code></pre></div>
</div>
</div>
<div id="approximate-change-in-fit" class="section level2">
<h2>Approximate Change in Fit</h2>
<p>The casewise loglikelihood—the contribution to the likelihood
function by an observation—can be computed in <code>lavaan</code>, which
approximates the change in loglikelihood when an observation is
deleted:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>lli <span class="ot">&lt;-</span> <span class="fu">lavInspect</span>(fit, <span class="at">what =</span> <span class="st">&quot;loglik.casewise&quot;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">head</span>(lli)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; [1] -2.776787 -2.034084 -2.154825 -2.248100 -2.793426 -2.049238</span></span></code></pre></div>
<p>Here, <span class="math inline">\(\ell(\hat \theta)\)</span> will
drop 2.78 when observation 1 is deleted. This should approximate <span class="math inline">\(\ell(\hat \theta_{(-i)})\)</span> as long as <span class="math inline">\(\hat \theta_{(-i)}\)</span> is not too different
from <span class="math inline">\(\hat \theta\)</span>. Here’s a
comparison:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Predicted ll without observation 1</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>fit<span class="sc">@</span>loglik<span class="sc">$</span>loglik <span class="sc">-</span> lli[<span class="dv">1</span>]</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; [1] -289.8272</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co"># Actual ll without observation 1</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>fit_no1 <span class="ot">&lt;-</span> <span class="fu">sem</span>(mod, dat[<span class="sc">-</span><span class="dv">1</span>, ])</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>fit_no1<span class="sc">@</span>loglik<span class="sc">$</span>loglik</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; [1] -289.8156</span></span></code></pre></div>
<p>They are pretty close. To approximate the change in <span class="math inline">\(\chi^2\)</span>, as well as other <span class="math inline">\(\chi^2\)</span>-based fit indices, we can use the
<code>fit_measures_change_approx()</code> function:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>chisq_i_approx <span class="ot">&lt;-</span> <span class="fu">fit_measures_change_approx</span>(fit)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co"># Compare to the actual chisq when dropping observation 1</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="fu">c</span>(<span class="at">predict =</span> chisq_i_approx[<span class="dv">1</span>, <span class="st">&quot;chisq&quot;</span>] <span class="sc">+</span> <span class="fu">fitmeasures</span>(fit, <span class="st">&quot;chisq&quot;</span>),</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="at">actual =</span> <span class="fu">fitmeasures</span>(fit_no1, <span class="st">&quot;chisq&quot;</span>))</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt; predict.chisq  actual.chisq </span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt;      6.871042      6.557397</span></span></code></pre></div>
<div id="comparing-exact-and-approximate-changes-in-fit-indices" class="section level3">
<h3>Comparing exact and approximate changes in fit indices</h3>
<p>Change in <span class="math inline">\(\chi^2\)</span></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Exact measure from semfindr</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">fit_measures_change</span>(fit_rerun)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>chisq_change_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="at">chisq_change =</span> out[ , <span class="st">&quot;chisq&quot;</span>],</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  <span class="at">chisq_change_approx =</span> chisq_i_approx[ , <span class="st">&quot;chisq&quot;</span>]</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="fu">ggplot</span>(chisq_change_df, <span class="fu">aes</span>(<span class="at">x =</span> chisq_change, <span class="at">y =</span> chisq_change_approx)) <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Change in RMSEA</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>rmsea_change_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="at">rmsea_change =</span> out[ , <span class="st">&quot;rmsea&quot;</span>],</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="at">rmsea_change_approx =</span> chisq_i_approx[ , <span class="st">&quot;rmsea&quot;</span>]</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="fu">ggplot</span>(rmsea_change_df, <span class="fu">aes</span>(<span class="at">x =</span> rmsea_change, <span class="at">y =</span> rmsea_change_approx)) <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The values aligned reasonably well along the 45-degree line.</p>
</div>
</div>
<div id="limitations" class="section level1">
<h1>Limitations</h1>
<ul>
<li><p>The approximate approach is tested only for models fitted by
maximum likelihood (ML) with normal theory standard errors (the
default).</p></li>
<li><p>The approximate approach does not yet support multilevel
models.</p></li>
</ul>
<p>The <code>lavaan</code> object will be checked by
<code>approx_check()</code> to see if it is supported. If not, an error
will be raised.</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>Cook, R. D., &amp; Weisberg, S. (1982). <em>Residuals and influence
in regression.</em> New York: Chapman and Hall. <a href="https://conservancy.umn.edu/handle/11299/37076" class="uri">https://conservancy.umn.edu/handle/11299/37076</a></p>
<p>Tanaka, Y., Watadani, S., &amp; Ho Moon, S. (1991). Influence in
covariance structure analysis: With an application to confirmatory
factor analysis. <em>Communications in Statistics - Theory and Methods,
20</em>(12), 3805–3821. <a href="https://doi.org/10.1080/03610929108830742" class="uri">https://doi.org/10.1080/03610929108830742</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
