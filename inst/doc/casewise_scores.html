<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />


<meta name="date" content="2024-04-08" />

<title>Approximate Case Influence Using Scores and Casewise Likelihood</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Approximate Case Influence Using Scores and
Casewise Likelihood</h1>
<h4 class="date">2024-04-08</h4>



<p>This vignette explains the computational shortcut implemented in <a href="https://sfcheung.github.io/semfindr/">semfindr</a> to approximate
the casewise influence. The approximation is most beneficial when the
sample size <em>N</em> is large, where the approximation works better
and the computational cost for refitting models <em>N</em> times is
high.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(semfindr)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>dat <span class="ot">&lt;-</span> pa_dat</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#&gt; This is lavaan 0.6-17</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt; lavaan is FREE software! Please report any bugs.</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>mod <span class="ot">&lt;-</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="st">m1 ~ iv1 + iv2</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="st">dv ~ m1</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(mod, dat)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">&quot;semfindr_fit_rerun.RDS&quot;</span>)) {</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>    fit_rerun <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;semfindr_fit_rerun.RDS&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    fit_rerun <span class="ot">&lt;-</span> <span class="fu">lavaan_rerun</span>(fit)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>    <span class="fu">saveRDS</span>(fit_rerun, <span class="st">&quot;semfindr_fit_rerun.RDS&quot;</span>)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  }</span></code></pre></div>
<div id="using-scores-to-approximate-case-influence" class="section level2">
<h2>Using Scores to Approximate Case Influence</h2>
<p><code>lavaan</code> provides the handy <code>lavScores()</code>
function to evaluate <span class="math display">\[s_i(\theta_m) =
\frac{\partial \ell_i(\theta_m)}{\partial \theta_m}\]</span> for
observation <span class="math inline">\(i\)</span>, where <span class="math inline">\(\ell_i(\theta)\)</span> denotes the casewise
loglikelihood function and <span class="math inline">\(\theta_m\)</span>
is the <span class="math inline">\(m\)</span>th model parameter.</p>
<p>For example,</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">lavScores</span>(fit)[ , <span class="dv">1</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt;           m1~iv1</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; [1,]  0.23975993</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; [2,]  0.06630118</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; [3,] -0.33999129</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; [4,] -0.22536120</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; [5,]  0.61375747</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; [6,]  0.03747179</span></span></code></pre></div>
<p>indicates the partial derivative of the casewise loglikelihod with
respect to the parameter <code>m1~iv1</code>. Because the sum of the
partial derivatives across all observations is zero at the maximum
likelihood estimate with the full sample (<span class="math inline">\(\hat \theta_m\)</span>; i.e., the derivative of
loglikelihood of the full data is 0), <span class="math inline">\(-
s_i(\theta_m)\)</span> can be used as an estimate of the partial
derivative of the loglikelihood at <span class="math inline">\(\hat
\theta_m\)</span> <strong>for the sample without observation <span class="math inline">\(i\)</span></strong>. This information can be used
to approximate the maximum likelihood estimate for <span class="math inline">\(\theta_m\)</span> when case <span class="math inline">\(i\)</span> is dropped, denoted as <span class="math inline">\(\hat \theta_{m(-i)}\)</span></p>
<p>The second-order Taylor series expansion can be used to approximate
the parameter vector estimate with an observation deleted, <span class="math inline">\(\hat \theta_{(-i)}\)</span>, as in the iterative
<a href="https://en.wikipedia.org/wiki/Newton%27s_method_in_optimization">Newton’s
method</a>. Specifically,</p>
<p><span class="math display">\[\hat \theta_{(i)} \approx \hat \theta -
\frac{N}{N - 1}V(\hat \theta) \nabla \ell(\hat \theta)\]</span> <span class="math display">\[\hat \theta - \hat \theta_{(i)} \approx
\frac{N}{N - 1}V(\hat \theta) \nabla \ell_i(\hat \theta),\]</span> where
<span class="math inline">\(\nabla \ell_i(\hat \theta)\)</span> is the
gradient vector of the casewise loglikelihood with respect to the
parameters (i.e., score). The <span class="math inline">\(N / (N -
1)\)</span> term is used to adjust for the decrease in sample size (this
adjustment is trivial in large samples). This procedure should be the
same as equation (4) of <a href="https://doi.org/10.1080/03610929108830742">Tanaka et
al. (1991)</a> (p. 3807) and is related to the one-step approximation
described by <a href="https://conservancy.umn.edu/handle/11299/37076">Cook and Weisberg
(1982)</a> (p. 182).</p>
<div id="comparison" class="section level3">
<h3>Comparison</h3>
<p>The approximation is implemented in the
<code>est_change_raw_approx()</code> function:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>fit_est_change_approx <span class="ot">&lt;-</span> <span class="fu">est_change_raw_approx</span>(fit)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>fit_est_change_approx</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; -- Approximate Case Influence on Parameter Estimates --</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt;    id m1~iv1  id m1~iv2 id  dv~m1  id m1~~m1 id dv~~dv</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; 1  51  0.042  43 -0.025 65  0.037  61  0.042 16  0.106</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; 2  43 -0.040  94  0.023 11 -0.027  85  0.040  9  0.050</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; 3  34 -0.032 100 -0.022 16 -0.024 100  0.037 76  0.049</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; 4  18 -0.028  85  0.021 32 -0.020  18  0.031 25  0.049</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; 5  13  0.028  20  0.020 99  0.020  42  0.028 91  0.043</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; 6  32 -0.025  32  0.019 79  0.018  43  0.025 17  0.039</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; 7  20 -0.024  65  0.019 93  0.018  32  0.023 26  0.028</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; 8  75  0.021  34 -0.018 22  0.017  34  0.022 65  0.027</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; 9  42 -0.020  64 -0.016 61 -0.016  40  0.022 62  0.027</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; 10 68  0.018  52  0.016 25 -0.015  20  0.022 90  0.024</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt; Note:</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt; - Changes are approximate raw changes if a case is included.</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt; - Only the first 10 case(s) is/are displayed. Set &#39;first&#39; to NULL to display all cases.</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt; - Cases sorted by the absolute changes for each variable.</span></span></code></pre></div>
<p>Here is a comparison between the approximation using
<code>semfindr::est_change_raw_approx()</code> and
<code>semfindr::est_change_raw()</code></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># From semfindr</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>fit_est_change_raw <span class="ot">&lt;-</span> <span class="fu">est_change_raw</span>(fit_rerun)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co"># Plot the differences</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>tmp1 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">t</span>(<span class="fu">as.matrix</span>(fit_est_change_raw)))</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>tmp2 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">t</span>(<span class="fu">as.matrix</span>(fit_est_change_approx)))</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>est_change_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">rep</span>(<span class="fu">colnames</span>(fit_est_change_raw),</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>                                        <span class="fu">nrow</span>(fit_est_change_raw)),</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>                             <span class="at">est_change =</span> tmp1,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>                             <span class="at">est_change_approx =</span> tmp2)</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="fu">ggplot</span>(est_change_df, <span class="fu">aes</span>(<span class="at">x =</span> est_change, <span class="at">y =</span> est_change_approx)) <span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> param) <span class="sc">+</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The results are pretty similar.</p>
</div>
<div id="generalized-cooks-distance-gcd" class="section level3">
<h3>Generalized Cook’s distance (<em>gCD</em>)</h3>
<p>We can use the approximate parameter changes to approximate the
<em>gCD</em> (see also Tanaka et al., 1991, equation 13, p. 3811):</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Information matrix (Hessian)</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>information_fit <span class="ot">&lt;-</span> <span class="fu">lavInspect</span>(fit, <span class="at">what =</span> <span class="st">&quot;information&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co"># Short cut for computing quadratic form (https://stackoverflow.com/questions/27157127/efficient-way-of-calculating-quadratic-forms-avoid-for-loops)</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>gcd_approx <span class="ot">&lt;-</span> (<span class="fu">nobs</span>(fit) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">rowSums</span>(</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  (fit_est_change_approx <span class="sc">%*%</span> information_fit) <span class="sc">*</span> fit_est_change_approx</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>)</span></code></pre></div>
<p>This is implemented in the <code>est_change_approx()</code>
function:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>fit_est_change_approx <span class="ot">&lt;-</span> <span class="fu">est_change_approx</span>(fit)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>fit_est_change_approx</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; -- Approximate Standardized Case Influence on Parameter Estimates --</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt;     m1~iv1 m1~iv2  dv~m1 m1~~m1 dv~~dv gcd_approx</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; 16   0.052 -0.038 -0.228 -0.006  0.572      0.372</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; 43  -0.387 -0.249 -0.135  0.201  0.116      0.270</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; 65   0.150  0.189  0.355  0.071  0.148      0.203</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; 85  -0.170  0.211 -0.118  0.315 -0.054      0.187</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; 51   0.405 -0.052  0.094  0.075 -0.046      0.179</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; 34  -0.306 -0.186 -0.110  0.176  0.028      0.163</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; 32  -0.241  0.190 -0.189  0.181 -0.002      0.161</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; 20  -0.234  0.199 -0.140  0.172 -0.034      0.144</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt; 18  -0.269  0.035  0.101  0.246 -0.048      0.143</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt; 100 -0.001 -0.221 -0.069  0.290 -0.058      0.137</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt; Note:</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; - Changes are approximate standardized raw changes if a case is included.</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt; - Only the first 10 case(s) is/are displayed. Set &#39;first&#39; to NULL to display all cases.</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt; - Cases sorted by approximate generalized Cook&#39;s distance.</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Compare to exact computation</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>fit_est_change <span class="ot">&lt;-</span> <span class="fu">est_change</span>(fit_rerun)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>gcd_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  <span class="at">gcd_exact =</span> fit_est_change[ , <span class="st">&quot;gcd&quot;</span>],</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>  <span class="at">gcd_approx =</span> fit_est_change_approx[ , <span class="st">&quot;gcd_approx&quot;</span>]</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>)</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="fu">ggplot</span>(gcd_df, <span class="fu">aes</span>(<span class="at">x =</span> gcd_exact, <span class="at">y =</span> gcd_approx)) <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The approximation tend to underestimate the actual <em>gCD</em> but
the rank ordering is almost identical. This is discussed also in Tanaka
et al. (1991), who proposed a correction by applying a one-step
approximation after the correction (currently not implemented due to the
need to recompute scores with updated parameter values).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">cor</span>(gcd_df, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt;            gcd_exact gcd_approx</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt; gcd_exact   1.000000   0.999892</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt; gcd_approx  0.999892   1.000000</span></span></code></pre></div>
</div>
</div>
<div id="approximate-change-in-fit" class="section level2">
<h2>Approximate Change in Fit</h2>
<p>The casewise loglikelihood—the contribution to the likelihood
function by an observation—can be computed in <code>lavaan</code>, which
approximates the change in loglikelihood when an observation is
deleted:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>lli <span class="ot">&lt;-</span> <span class="fu">lavInspect</span>(fit, <span class="at">what =</span> <span class="st">&quot;loglik.casewise&quot;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">head</span>(lli)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; [1] -2.776787 -2.034084 -2.154825 -2.248100 -2.793426 -2.049238</span></span></code></pre></div>
<p>Here, <span class="math inline">\(\ell(\hat \theta)\)</span> will
drop 2.78 when observation 1 is deleted. This should approximate <span class="math inline">\(\ell(\hat \theta_{(-i)})\)</span> as long as <span class="math inline">\(\hat \theta_{(-i)}\)</span> is not too different
from <span class="math inline">\(\hat \theta\)</span>. Here’s a
comparison:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Predicted ll without observation 1</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>fit<span class="sc">@</span>loglik<span class="sc">$</span>loglik <span class="sc">-</span> lli[<span class="dv">1</span>]</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; [1] -289.8272</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co"># Actual ll without observation 1</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>fit_no1 <span class="ot">&lt;-</span> <span class="fu">sem</span>(mod, dat[<span class="sc">-</span><span class="dv">1</span>, ])</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>fit_no1<span class="sc">@</span>loglik<span class="sc">$</span>loglik</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; [1] -289.8156</span></span></code></pre></div>
<p>They are pretty close. To approximate the change in <span class="math inline">\(\chi^2\)</span>, as well as other <span class="math inline">\(\chi^2\)</span>-based fit indices, we can use the
<code>fit_measures_change_approx()</code> function:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>chisq_i_approx <span class="ot">&lt;-</span> <span class="fu">fit_measures_change_approx</span>(fit)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co"># Compare to the actual chisq when dropping observation 1</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="fu">c</span>(<span class="at">predict =</span> chisq_i_approx[<span class="dv">1</span>, <span class="st">&quot;chisq&quot;</span>] <span class="sc">+</span> <span class="fu">fitmeasures</span>(fit, <span class="st">&quot;chisq&quot;</span>),</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="at">actual =</span> <span class="fu">fitmeasures</span>(fit_no1, <span class="st">&quot;chisq&quot;</span>))</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt; predict.chisq  actual.chisq </span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt;      6.871042      6.557397</span></span></code></pre></div>
<div id="comparing-exact-and-approximate-changes-in-fit-indices" class="section level3">
<h3>Comparing exact and approximate changes in fit indices</h3>
<p>Change in <span class="math inline">\(\chi^2\)</span></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Exact measure from semfindr</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">fit_measures_change</span>(fit_rerun)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>chisq_change_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="at">chisq_change =</span> out[ , <span class="st">&quot;chisq&quot;</span>],</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  <span class="at">chisq_change_approx =</span> chisq_i_approx[ , <span class="st">&quot;chisq&quot;</span>]</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="fu">ggplot</span>(chisq_change_df, <span class="fu">aes</span>(<span class="at">x =</span> chisq_change, <span class="at">y =</span> chisq_change_approx)) <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Change in RMSEA</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>rmsea_change_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="at">rmsea_change =</span> out[ , <span class="st">&quot;rmsea&quot;</span>],</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="at">rmsea_change_approx =</span> chisq_i_approx[ , <span class="st">&quot;rmsea&quot;</span>]</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="fu">ggplot</span>(rmsea_change_df, <span class="fu">aes</span>(<span class="at">x =</span> rmsea_change, <span class="at">y =</span> rmsea_change_approx)) <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The values aligned reasonably well along the 45-degree line.</p>
</div>
</div>
<div id="limitations" class="section level1">
<h1>Limitations</h1>
<ul>
<li><p>The approximate approach is tested only for models fitted by
maximum likelihood (ML) with normal theory standard errors (the
default).</p></li>
<li><p>The approximate approach does not yet support multilevel
models.</p></li>
</ul>
<p>The <code>lavaan</code> object will be checked by
<code>approx_check()</code> to see if it is supported. If not, an error
will be raised.</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>Cook, R. D., &amp; Weisberg, S. (1982). <em>Residuals and influence
in regression.</em> New York: Chapman and Hall. <a href="https://conservancy.umn.edu/handle/11299/37076" class="uri">https://conservancy.umn.edu/handle/11299/37076</a></p>
<p>Tanaka, Y., Watadani, S., &amp; Ho Moon, S. (1991). Influence in
covariance structure analysis: With an application to confirmatory
factor analysis. <em>Communications in Statistics - Theory and Methods,
20</em>(12), 3805–3821. <a href="https://doi.org/10.1080/03610929108830742" class="uri">https://doi.org/10.1080/03610929108830742</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
